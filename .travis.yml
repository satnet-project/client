sudo: false

language: 'python'
cache: pip

branches:
  only:
    - master
    - development

python:
  - '2.7'

git:
  submodules: false

before_script:
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - sleep 3

install:
  - cd scripts
  - bash ./setup.sh -travisCI
  - cd ../tests
  - mkdir build
  - cd build
  - git clone https://github.com/PySide/pyside-setup.git pyside-setup
  - cd pyside-setup
  - python setup.py bdist_wheel --qmake=/usr/bin/qmake-qt4 --version=1.2.4
  - pip install dist/PySide-1.2.4*
  - cd ../..
  - ls
  - pwd

script:
#  - cd tests
  - trial test_readDataFromFile.py
  - trial test_readDataFromTerminal.py
#  - trial test_notifyMsgUsage
  - trial test_saveReceivedFrames.py
#  - trial test_connectionDown
#  - trial test_connectionEstablished
  - trial test_manageFrames.py
  - trial test_userinterfacesoperation
  - trial test_userinterfacesparameters
#  - trial test_integrationConnection
  - trial test_configurationWindowOperation.py
  - coverage run test_readDataFromFile.py
  - coverage run test_readDataFromTerminal.py

after_success:
  - coverage combine
  - coverage report --omit '/home/travis/virtualenv/*'
  - coveralls --rcfile='/home/travis/build/satnet-project/generic-client/.coveragerc'